<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VRFS Kits</title>
<style>
body { font-family: Arial, sans-serif; background: #111; color: #fff; padding: 20px; }
.kit-card { background: #1a1a1a; padding: 15px; margin: 10px 0; border-radius: 10px; }
img { max-width: 200px; border-radius: 6px; }
</style>
</head>
<body>
<h1>VRFS Kits</h1>
<div id="kits"></div>


<h2>Upload Kit</h2>
<form id="uploadForm">
<input type="text" name="club" placeholder="Club Name" required><br><br>
<input type="text" name="kit_code" placeholder="Kit Code" required><br><br>
<input type="text" name="image_url" placeholder="Image URL" required><br><br>
<input type="text" name="uploader" placeholder="Uploader Name" required><br><br>
<input type="text" name="notes" placeholder="Notes"><br><br>
<button type="submit">Upload</button>
</form>
<p id="status"></p>


<script>
// CSV METHOD
async function fetchKits(){
const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRHLmtXKSpBJQ6r839R4ZToiFsb6nyaqhhHWV543DyS9PUaiRRgwBRlPSDiMbjGmvGdAg7ND2Gnn6_n/pub?output=csv';
const r = await fetch(csvUrl);
const text = await r.text();
const lines = text.trim().split(/
?
/);
return lines.slice(1).map(row => {
const c = row.split(',');
return { timestamp: c[0], club: c[1], kit_code: c[2], image_url: c[3], uploader: c[4], notes: c[5] };
});
}


async function loadKits(){
const list = document.getElementById('kits');
list.innerHTML = 'Loading...';
const kits = await fetchKits();
list.innerHTML = '';
kits.forEach(k => {
const div = document.createElement('div');
div.className = 'kit-card';
div.innerHTML = `
<h3>${k.club}</h3>
<p><b>Code:</b> ${k.kit_code}</p>
<img src="${k.image_url}" />
<p><b>Uploader:</b> ${k.uploader}</p>
<p>${k.notes}</p>
`;
list.appendChild(div);
});
}
loadKits();


// UPLOAD HANDLER
const GAS_POST_URL = 'https://script.google.com/macros/s/AKfycbz4rWmskyt9lRohhUCFK4NREs1l9lxxr7BYm6ctXm2hTrv8omFmYmoxR4FtVEQWkM9oPQ/exec';


document.getElementById('uploadForm').addEventListener('submit', async (e) => {
e.preventDefault();
const form = new FormData(e.target);
const obj = Object.fromEntries(form.entries());


const res = await fetch(GAS_POST_URL, {
method: 'POST',
body: new URLSearchParams(obj)
});
const text = await res.text();
document.getElementById('status').innerText = text;
});
</script>
</body>
</html>
